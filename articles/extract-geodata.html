<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gisr">
<title>Extract Geodata from different sources • gisr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract Geodata from different sources">
<meta property="og:description" content="gisr">
<meta property="og:image" content="https://usaid-oha-si.github.io/gisr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gisr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/create-terrain-basemap.html">Create Terrain Basemap</a>
    <a class="dropdown-item" href="../articles/extract-facilities.html">Extract facilities location data</a>
    <a class="dropdown-item" href="../articles/extract-geodata.html">Extract Geodata from different sources</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USAID-OHA-SI/gisr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extract Geodata from different sources</h1>
                        <h4 data-toc-skip class="author">Baboyma
Kagniniwa</h4>
            
            <h4 data-toc-skip class="date">2021-09-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/USAID-OHA-SI/gisr/blob/HEAD/vignettes/extract-geodata.Rmd" class="external-link"><code>vignettes/extract-geodata.Rmd</code></a></small>
      <div class="d-none name"><code>extract-geodata.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette provides some guidance to USAID/OHA Data Analysts on
how to extract geospatial data from different sources</p>
</div>
<div class="section level2">
<h2 id="geospatial-datasets">Geospatial Datasets<a class="anchor" aria-label="anchor" href="#geospatial-datasets"></a>
</h2>
<p>PEPFAR/ICPI GIS Cluster provides a global geospatial data set that
define the boundaries of PEPFAR countries organizational units. This
data set contains all country, SNU, PSNU and Community boundaries along
with their respective unique identification id (uid) and have been used
thematic mapping and other spatial analyses. Other external data sources
such as <a href="https://www.naturalearthdata.com/downloads/" class="external-link">Naturalearh</a> and
<a href="https://gadm.org/download_country_v3.html" class="external-link">GADM</a> have also
been very helpful.</p>
<p>Below are different ways analysts could / should be using this
package to extract PEPFAR geodata for their respective countries.</p>
</div>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/USAID-OHA-SI/glamr" class="external-link">glamr</a></span><span class="op">)</span>         <span class="co"># OHA/SI utility package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/USAID-OHA-SI/gisr" class="external-link">gisr</a></span><span class="op">)</span>          <span class="co"># OHA/SI geospatial package </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span>            <span class="co"># Spatial data management</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="locate-and-setup-vector-data-path">Locate and setup vector data path<a class="anchor" aria-label="anchor" href="#locate-and-setup-vector-data-path"></a>
</h2>
<p>Current PEPFAR Geospatial data sets can be found under OHA/SI Google
Drive <code>SI Folder</code> and in <code>Spatial Files</code>
sub-folder.</p>
<p>In order to take full advantage of all the OHA/SI R packages, it’s
recommended to setup the location of your data directories. These should
ideally be outside your github projects directory. One of the
directories should be dedicated to geospatial data and should be set
using
<code>glamr::set_paths(folderpath_vector = "&lt;my-geodata-folder&gt;")</code>.</p>
<p>Below is an example. This assumes your R / Github projects folder is
under <code>Documents</code> folder on your local computer and your
working off a R Project in a sub-folder. In this example, your
geospatial data folder will be a sibling of your R / Github projects
folder.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">curr_path</span> <span class="op">&lt;-</span> <span class="st">"C:/Users/&lt;username&gt;/Documents/projects/gisr"</span> <span class="co"># Windows</span></span>
<span><span class="co">#or </span></span>
<span><span class="co">#curr_path &lt;- "~/Documents/projects/gisr"                  # Mac or linux</span></span>
<span></span>
<span><span class="va">geopath</span> <span class="op">&lt;-</span> <span class="st">"../../Geodata"</span></span>
<span></span>
<span><span class="fu">glamr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/glamr/man/set_paths.html" class="external-link">set_paths</a></span><span class="op">(</span>folderpath_vector <span class="op">=</span> <span class="va">geopath</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># verify path</span></span>
<span><span class="fu">glamr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/glamr/man/si_path.html" class="external-link">si_path</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"path_vector"</span><span class="op">)</span></span></code></pre></div>
<p>The geospatial data path is now set. Download PEPFAR
<code>VcPepfarPolygons.shp</code> file from the above mentioned Google
Drive to the newly set local folder.</p>
</div>
<div class="section level2">
<h2 id="read-geospatial-data">Read geospatial data<a class="anchor" aria-label="anchor" href="#read-geospatial-data"></a>
</h2>
<p>Time to test some of the <code>gisr</code> functions. Let</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this works for the perfect setup with the default parameters values</span></span>
<span><span class="va">spdf_pepfar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_vcpolygons.html">get_vcpolygons</a></span><span class="op">(</span>folderpath <span class="op">=</span> <span class="va">geopath</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># for custom use, you will need to specify the path and name of the file</span></span>
<span><span class="va">spdf_pepfar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_vcpolygons.html">get_vcpolygons</a></span><span class="op">(</span>folderpath <span class="op">=</span> <span class="st">"../myshapefiles"</span>, name <span class="op">=</span> <span class="st">"pepfar.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Explore outputs</span></span>
<span><span class="va">spdf_pepfar</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spdf_pepfar</span></span></code></pre></div>
<p>Now that the PEPFAR Boundaries shapefile can be accessed and read in
R, how does one extract specific boundaries for their countries?</p>
</div>
<div class="section level2">
<h2 id="extract-country-orgunit-boundaries">Extract country orgunit boundaries<a class="anchor" aria-label="anchor" href="#extract-country-orgunit-boundaries"></a>
</h2>
<p>In order to extract country specific boundaries, you will need to
provide the country name and the orgunit level. Below is an example for
South Africa.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cntry</span> <span class="op">&lt;-</span> <span class="st">"South Africa"</span></span></code></pre></div>
<p>Extract country boundaries</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cntry_lvl</span> <span class="op">&lt;-</span> <span class="fu">grabr</span><span class="fu">::</span><span class="fu">get_ouorglevel</span><span class="op">(</span></span>
<span>  operatingunit <span class="op">=</span> <span class="va">cntry</span>,</span>
<span>  country <span class="op">=</span> <span class="va">cntry</span>,</span>
<span>  org_type <span class="op">=</span> <span class="st">"country"</span>,</span>
<span>  username <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glamr/man/datim_user.html" class="external-link">datim_user</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glamr/man/datim_pwd.html" class="external-link">datim_pwd</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Country boundaries</span></span>
<span><span class="va">spdf_cntry</span> <span class="op">&lt;-</span> <span class="va">spdf_pepfar</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/extract_boundaries.html">extract_boundaries</a></span><span class="op">(</span>country <span class="op">=</span> <span class="va">cntry</span>, </span>
<span>                     level <span class="op">=</span> <span class="va">cntry_lvl</span>,</span>
<span>                     username <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glamr/man/datim_user.html" class="external-link">datim_user</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glamr/man/datim_pwd.html" class="external-link">datim_pwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spdf_cntry</span></span></code></pre></div>
<p>Extract PSNU boundaries</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">psnu_lvl</span> <span class="op">&lt;-</span> <span class="fu">grabr</span><span class="fu">::</span><span class="fu">get_ouorglevel</span><span class="op">(</span></span>
<span>  operatingunit <span class="op">=</span> <span class="va">cntry</span>,</span>
<span>  country <span class="op">=</span> <span class="va">cntry</span>,</span>
<span>  org_type <span class="op">=</span> <span class="st">"prioritization"</span>,</span>
<span>  username <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glamr/man/datim_user.html" class="external-link">datim_user</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glamr/man/datim_pwd.html" class="external-link">datim_pwd</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># psnu boundaries</span></span>
<span><span class="va">spdf_psnu</span> <span class="op">&lt;-</span> <span class="va">spdf_pepfar</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/extract_boundaries.html">extract_boundaries</a></span><span class="op">(</span>country <span class="op">=</span> <span class="va">cntry</span>, </span>
<span>                     level <span class="op">=</span> <span class="va">cntry_lvl</span>,</span>
<span>                     username <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glamr/man/datim_user.html" class="external-link">datim_user</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/glamr/man/datim_pwd.html" class="external-link">datim_pwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spdf_psnu</span></span></code></pre></div>
<p>Extract all country boundaries</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">spdf_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cntry_polygons.html">cntry_polygons</a></span><span class="op">(</span>spdf <span class="op">=</span> <span class="va">spdf_pepfar</span>, cntry <span class="op">=</span> <span class="va">cntry</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spdf_all</span><span class="op">$</span><span class="va">country</span></span>
<span><span class="va">spdf_all</span><span class="op">$</span><span class="va">snu1</span></span>
<span><span class="va">spdf_all</span><span class="op">$</span><span class="va">prioritization</span></span>
<span><span class="va">spdf_all</span><span class="op">$</span><span class="va">community</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="download-pre-parsed-geodata">Download pre-parsed geodata<a class="anchor" aria-label="anchor" href="#download-pre-parsed-geodata"></a>
</h2>
<p>PEPFAR Geospatial dataset have already been parsed out and can be
downloaded to a local directory.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Download country boundaries</span></span>
<span><span class="fu"><a href="../reference/download_shapefiles.html">download_shapefiles</a></span><span class="op">(</span>country <span class="op">=</span> <span class="va">cntry</span>, org_label <span class="op">=</span> <span class="st">"country"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download PSNU boundaries</span></span>
<span><span class="fu"><a href="../reference/download_shapefiles.html">download_shapefiles</a></span><span class="op">(</span>country <span class="op">=</span> <span class="va">cntry</span>, org_label <span class="op">=</span> <span class="st">"prioritization"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extract-data-from-other-sources">Extract Data from other sources<a class="anchor" aria-label="anchor" href="#extract-data-from-other-sources"></a>
</h2>
<p>Contextual geospatial data sets can also be extracted from external
sources using <code><a href="../reference/get_admin0.html">get_admin0()</a></code>, <code><a href="../reference/get_admin1.html">get_admin1()</a></code>,
<code>get_adm_boundaries()</code></p>
</div>
<div class="section level2">
<h2 id="export-geospatial-data-to-local-drive">Export Geospatial Data to local drive<a class="anchor" aria-label="anchor" href="#export-geospatial-data-to-local-drive"></a>
</h2>
<p>Take a look at <code><a href="../reference/spdf_export.html">spdf_export()</a></code></p>
<div class="section level3">
<h3 id="thank-you">Thank you!<a class="anchor" aria-label="anchor" href="#thank-you"></a>
</h3>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Baboyma Kagniniwa.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
